/*    HTTP Host:  static.ak.fbcdn.net                                          */
/*    Generated:  October 21st 2009 8:52:04 PM PDT                             */
/*      Machine:  10.16.139.104                                                */
/*       Source:  Local Cache                                                  */
/*     Location:  rsrc:4:42c81b62                                              */
/*       Locale:  nu_ll                                                        */
/*       JSXMIN:  Success                                                      */
/*         Path:  js/emu/controller.js                                         */

((location=='about:blank'&&(window.parent.eval_global||window.parent.eval))||(window.eval_global||window.eval))("function EMUFrame(_L0,_L1,_L2,_L3,_L4){this.eiData_=_L1;this.flags_=_L3;this.contextType_=_L2;this.data_=_L4;this.containerId_=_L0;this.container_=$(this.containerId_);DataStore.set(this.container_,'emuClient',this);return this;}copy_properties(EMUFrame,{getClient:function(_L0){var _L1=ge(_L0);if(!_L1)return null;return DataStore.get(_L1,'emuClient');}});copy_properties(EMUFrame.prototype,{EVENT_HANDLER_PATH:'\/ae.php',EVENT_NAME_CLICK:'clk',EVENT_NAME_FAN:'fan',EVENT_NAME_RSVP:'rsvp',EVENT_NAME_ADD_FRIEND:'frnd',EVENT_NAME_GET_DIALOG:'dlg',EVENT_NAME_LIKE:'like',EVENT_NAME_UNLIKE:'unlike',EVENT_NAME_CAME_BACK:'cameback',FLAG_LOGGING_DISABLED:1,FLAG_FEEDBACK_DISABLED:2,FLAG_LOGGING_DISABLED_JAVASCRIPT:4,FLAG_ADS_NO_REFRESH_ON_DISLIKE:8,onEvent:function(_L0,_L1,_L2,_L3){var _L4={i:this.eiData_,f:this.flags_,c:this.contextType_,en:_L0};if(_L1)_L4.ed=JSON.encode(_L1);if(!_L3)var _L3=bagofholding;if(_L2)new AsyncRequest().setURI(this.EVENT_HANDLER_PATH).setData(_L4).setHandler(_L2).setErrorHandler(_L3).setTransportErrorHandler(_L3).send();else new AsyncSignal(this.EVENT_HANDLER_PATH,_L4).send();},showContextualHelp:function(_L0,_L1,_L2){return new ContextualDialog().setContext(_L0).setTitle(_L1).setBody(_L2).setButtons(Dialog.OK).show();},setClicked:function(_L0){if(this.clicked_)return;if(_L0.getModifiers().any||_L0.button!=0)return;this.listeners_=[Event.listen(document.body,'mousedown',this.cameBack.bind(this)),Event.listen(window,'scroll',this.cameBack.bind(this)),Event.listen(window,'unload',this.cameBack.bind(this))];this.clicked_=(+new Date());},cameBack:function(_L0){if(!this.clicked_)return;var _L1=(+new Date())-this.clicked_;for(var _L2=this.listeners_.length;_L2--;)this.listeners_[_L2].remove();this.listeners_=[];this.clicked_=false;this.onEvent(this.EVENT_NAME_CAME_BACK,_L1);},flashHighlightElement:function(_L0){if(!_L0)return;$(_L0).setStyle('backgroundColor','#fffccc');animation(_L0).duration(1500).checkpoint().to('backgroundColor','#FFFFFF').duration(1000).go();}});function EMUASFrame(_L0,_L1,_L2,_L3,_L4){this.parent.construct(this,_L0,_L1,_L2,_L3,_L4);this.linkTitle_=DOM.find(this.container_,'a.UIEMUASFrame_title');this.linkImageAndBody_=DOM.find(this.container_,'a.UIEMUASFrame_imageAndBody');this.linkImageAndBody_.listen('mouseover',function(){CSS.addClass(this.linkTitle_,'underlined_title');}.bind(this));this.linkImageAndBody_.listen('mouseout',function(){CSS.removeClass(this.linkTitle_,'underlined_title');}.bind(this));if(this.data_.isPreview){this.linkTitle_.listen('click',this.onLinkPreview.bind(this,this.linkTitle_));this.linkImageAndBody_.listen('click',this.onLinkPreview.bind(this,this.linkImageAndBody_));var _L5=DOM.scry(this.container_,'a.UIEmuSocialContext_link');for(var _L6=0;_L6<_L5.length;_L6++)_L5[_L6].listen('click',this.onSocialLinkPreview.bind(this,_L5[_L6]));}else if(this.data_.isNewWindow){Event.listen(this.linkTitle_,'click',this.setClicked.bind(this));Event.listen(this.linkImageAndBody_,'click',this.setClicked.bind(this));}return this;}EMUASFrame.extend('EMUFrame');copy_properties(EMUASFrame.prototype,{onLinkPreview:function(_L0){var _L1='';if('#'!=_L0.getAttribute('href')){var _L2={href:_L0.getAttribute('href'),target:'_blank'};var _L3=$N('span',$N('a',_L2,_tx(\"Preview link.\")));var _L1=_L3.innerHTML;}this.showContextualHelp(_L0,_tx(\"Linkable Area\"),_tx(\"Users who click this area will link to the destination specified by this ad. {preview}\",{preview:_L1}));return false;},onSocialLinkPreview:abstractMethod});function EMUASStandardFrame(_L0,_L1,_L2,_L3,_L4){this.parent.construct(this,_L0,_L1,_L2,_L3,_L4);}EMUASStandardFrame.extend('EMUASFrame');function EMUASFanFrame(_L0,_L1,_L2,_L3,_L4){this.parent.construct(this,_L0,_L1,_L2,_L3,_L4);var _L5=DOM.scry(this.container_,'a.UIEMUASfanFrame_becomeFanLink');if(_L5[0]){var _L6=(!this.data_.isPreview)?this.onFan.bind(this):this.onFanPreview.bind(this,_L5[0]);_L5[0].listen('click',_L6);}return this;}EMUASFanFrame.extend('EMUASFrame');copy_properties(EMUASFanFrame.prototype,{onFan:function(){if(this.locked_)return false;this.locked_=true;this.onEvent(this.EVENT_NAME_FAN,null,this.onFanFrameResponse.bind(this),this.onFanFrameResponse.bind(this));return false;},onFanFrameResponse:function(_L0){var _L1=_L0.getPayload();if(_L1.success){var _L2=DOM.find(this.container_,'div.UIEMUASFrame_action .UIImageBlock_Content');DOM.setContent(_L2,this.data_.justFannedString);this.flashHighlightElement(_L2);}this.locked_=false;},onFanPreview:function(_L0){this.showContextualHelp(_L0,_tx(\"Inline Facebook Page Fanning\"),_tx(\"Users can directly fan your Facebook Page by clicking this link.\"));return false;},onSocialLinkPreview:function(_L0){this.showContextualHelp(_L0,_tx(\"Social Actions\"),_tx(\"Here users can see friends who have become a fan of your Facebook Page.\"));return false;}});function EMUASSLikeFrame(_L0,_L1,_L2,_L3,_L4){this.parent.construct(this,_L0,_L1,_L2,_L3,_L4);var _L5=DOM.scry(this.container_,'a.UIEMUASSLikeFrame_likeLink');if(_L5[0]){var _L6=(!this.data_.isPreview)?this.onLike.bind(this):this.onLikePreview.bind(this,_L5[0]);_L5[0].listen('click',_L6);}var _L7=DOM.scry(this.container_,'a.UIEMUASSLikeFrame_unlikeLink');if(_L7[0]){var _L6=this.onUnlike.bind(this);_L7[0].listen('click',_L6);}return this;}EMUASSLikeFrame.extend('EMUASFrame');copy_properties(EMUASSLikeFrame.prototype,{onLike:function(){if(this.locked_)return false;this.locked_=true;this.onEvent(this.EVENT_NAME_LIKE,null,this.onLikeFrameResponse.bind(this),this.onLikeFrameResponse.bind(this));return false;},onUnlike:function(){if(this.locked_)return false;this.locked_=true;this.onEvent(this.EVENT_NAME_UNLIKE,null,this.onUnlikeFrameResponse.bind(this),this.onUnlikeFrameResponse.bind(this));return false;},onLikeFrameResponse:function(_L0){var _L1=_L0.getPayload();if(_L1.success){var _L2=DOM.find(this.container_,'.UIEMUASSLikeFrame_like');var _L3=DOM.find(_L2,'span.UIEMUASSLikeFrame_likeAction');var _L4=DOM.find(_L2,'span.UIEMUASSLikeFrame_unlikeAction');var _L5=DOM.find(_L2,'span.UIEMUASSLikeFrame_liked');CSS.addClass(_L3,'hidden');CSS.removeClass(_L4,'hidden');CSS.removeClass(_L5,'hidden');var _L6=DOM.find(this.container_,'span.UIEMUASSLikeFrame_withoutLike');var _L7=DOM.find(this.container_,'span.UIEMUASSLikeFrame_withLike');CSS.removeClass(_L7,'hidden');CSS.addClass(_L6,'hidden');this.flashHighlightElement(_L2);}this.locked_=false;},onUnlikeFrameResponse:function(_L0){var _L1=_L0.getPayload();if(_L1.success){var _L2=DOM.find(this.container_,'.UIEMUASSLikeFrame_like');var _L3=DOM.find(_L2,'span.UIEMUASSLikeFrame_likeAction');var _L4=DOM.find(_L2,'span.UIEMUASSLikeFrame_unlikeAction');var _L5=DOM.find(_L2,'span.UIEMUASSLikeFrame_liked');CSS.removeClass(_L3,'hidden');CSS.addClass(_L4,'hidden');CSS.addClass(_L5,'hidden');var _L6=DOM.find(this.container_,'span.UIEMUASSLikeFrame_withoutLike');var _L7=DOM.find(this.container_,'span.UIEMUASSLikeFrame_withLike');CSS.addClass(_L7,'hidden');CSS.removeClass(_L6,'hidden');this.flashHighlightElement(_L2);}this.locked_=false;},onLikePreview:function(_L0){this.showContextualHelp(_L0,_tx(\"Inline Ad Liking\"),_tx(\"Users can like your ad by clicking this link.\"));return false;},onSocialLinkPreview:function(_L0){this.showContextualHelp(_L0,_tx(\"Social Actions\"),_tx(\"Here users can see friends who have liked your ad.\"));return false;}});function EMUASEventFrame(_L0,_L1,_L2,_L3,_L4){this.parent.construct(this,_L0,_L1,_L2,_L3,_L4);var _L5=DOM.scry(this.container_,'a.UIEMUASEventFrame_rsvpLink');if(_L5[0]){var _L6=(!this.data_.isPreview)?this.onRSVP.bind(this):this.onRSVPPreview.bind(this,_L5[0]);_L5[0].listen('click',_L6);}return this;}EMUASEventFrame.extend('EMUASFrame');copy_properties(EMUASEventFrame.prototype,{onRSVP:function(){if(!this.dialog_){this.dialog_=new Dialog().setTitle(this.data_.eventName).setBody(_tx(\"Loading...\")).show();this.onEvent(this.EVENT_NAME_GET_DIALOG,null,this.initRSVPDialog.bind(this),this.initRSVPDialogFail.bind(this));}return false;},initRSVPDialog:function(_L0){var _L1=_L0.getPayload();if(_L1.success)this.dialog_.setBody(_L1.dialogBody).setButtons([{name:'rsvp',label:_tx(\"RSVP\")},Dialog.CANCEL]).setCancelHandler(this.onRSVPCancel.bind(this)).setHandler(this.onRSVPSubmit.bind(this)).show();return false;},initRSVPDialogFail:function(_L0){this.dialog_.hide();this.dialog_=null;},onRSVPCancel:function(){this.dialog_=null;},onRSVPSubmit:function(){if(this.locked_)return false;this.locked_=true;var _L0=this.dialog_.getFormData().UIEMUASEventFrame_dialogRSVPSelect;this.onEvent(this.EVENT_NAME_RSVP,{rsvpStatus:_L0},this.onRSVPFrameResponse.bind(this),this.onRSVPFrameResponse.bind(this));this.dialog_=null;},onRSVPFrameResponse:function(_L0){var _L1=_L0.getPayload();if(_L1.success){var _L2=DOM.find(this.container_,'div.UIEMUASFrame_action .UIImageBlock_Content');DOM.setContent(_L2,_L1.statusString);this.flashHighlightElement(_L2);}this.locked_=false;},onRSVPPreview:function(_L0){this.showContextualHelp(_L0,_tx(\"Inline Event RSVP'ing\"),_tx(\"Users can directly RSVP to your event by clicking this link.\"));return false;},onSocialLinkPreview:function(_L0){this.showContextualHelp(_L0,_tx(\"Social Actions\"),_tx(\"Here users can see friends who have RSVP'd to your event. \"));return false;}});function EMUASPymkFrame(_L0,_L1,_L2,_L3,_L4){this.parent.construct(this,_L0,_L1,_L2,_L3,_L4);this.linkTitle_.listen('click',this.onPymkClick.bind(this));this.linkImageAndBody_.listen('click',this.onPymkClick.bind(this));var _L5=DOM.scry(this.container_,'a.UIEMUASPymkFrame_friendLink');if(_L5[0])_L5[0].listen('click',this.onAddFriend.bind(this));var _L6=DOM.scry(this.container_,'a.UIEMUASPymkFrame_explanation');if(_L6[0])_L6[0].listen('click',this.onExplanation.bind(this));if(_L4.pymkIsHideable){this.arbiterHideToken_=Arbiter.subscribe('emu\/hide',bind(this,'onPymkHide'));onunloadRegister(bind(this,'arbiterUnsubscribeHide'));}return this;}EMUASPymkFrame.extend('EMUASFrame');copy_properties(EMUASPymkFrame.prototype,{HIDE_ASYNC_PATH:'\/ajax\/pymk_emu.php',onPymkClick:function(){pymk_log_profile_click(this.data_.pymkId,this.data_.pymkPage,this.data_.pymkScore,this.data_.pymkSource);},onPymkHide:function(_L0,_L1){if(!ge(this.container_.id)){this.arbiterUnsubscribeHide();return;}var _L2={replace:this.data_.pymkId,page:this.data_.pymkPage,score:this.data_.pymkScore||-1,source:this.data_.pymkSource};new AsyncRequest().setURI(this.HIDE_ASYNC_PATH).setData(_L2).setHandler(this.onPymkHideResponse.bind(this)).send();animation(this.container_).from('opacity',1).to('opacity',0).duration(400).go();},onPymkHideResponse:function(_L0){var _L1=DOM.replace(this.container_,HTML(_L0.payload));this.arbiterUnsubscribeHide();if(!_L1[0])return;animation(_L1[0]).from('opacity',0).to('opacity',1).duration(400).go();},arbiterUnsubscribeHide:function(){if(this.arbiterHideToken_)Arbiter.unsubscribe(this.arbiterHideToken_);},onAddFriend:function(){var _L0=new ConnectDialog(this.data_.pymkId,'people_you_may_know',this.onAddFriendCompleted.bind(this),{'uid':this.data_.pymkId,'render_explanation':true,'page':this.data_pymkPage},false,null,this.data_.pymkScore,this.data_.pymkSource,this.data_.pymkPage);_L0.show();return false;},onExplanation:function(_L0){(new Dialog()).setTitle(this.data_.pymkExplanationTitle).setBody(this.data_.pymkExplanationBody).setButtons(Dialog.OK).show();return false;},onAddFriendCompleted:function(){if(this.locked_)return false;this.locked_=true;this.onEvent(this.EVENT_ADD_FRIEND);var _L0=DOM.find(this.container_,'.UIEMUASPymkFrame_friend');DOM.setContent(_L0,this.data_.pymkAddedString);this.flashHighlightElement(_L0);this.locked_=false;}});function emu_action_wrapper(_L0){EMUFrame.getClient(_L0.divId).onEvent(_L0.eventName,_L0.eventData);return false;}\n\nif (window.Bootloader) { Bootloader.done([\"js\\\/emu\\\/controller.js\"]); }")